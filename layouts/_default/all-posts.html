{{ define "main" }}
<link rel="stylesheet" href="{{ "css/all-posts.css" | relURL }}">

<div class="container">
    <div class="page-header">
        <h1 class="page-title">{{ i18n "all_posts" }}</h1>
        <p class="page-subtitle">{{ .Summary }}</p>
    </div>

    <div class="filter-bar">
        <button class="filter-btn active" data-filter="all">{{ i18n "all_posts" }}</button>
        <button class="filter-btn" data-filter="tech">ðŸ’» Tech</button>
    </div>

    <div class="posts-grid" id="postsGrid">
        {{ $currentLangPages := where .Site.RegularPages "Language.Lang" .Site.Language.Lang }}
        {{ $posts := where $currentLangPages "Type" "in" (slice "tech") }}
        {{ range $posts }}
        <a href="{{ .Permalink }}" class="post-card" data-category="{{ index .Params.categories 0 }}">
            {{ if .Params.image }}
            <img src="{{ .Params.image | relURL }}" alt="{{ .Title }}" class="post-card-thumbnail">
            {{ end }}
            <div class="post-card-content">
                <div class="post-card-header">
                    <span class="post-card-date">
                        {{ if eq $.Site.Language.Lang "ko" }}
                            {{ .Date.Format "2006.01.02" }}
                        {{ else }}
                            {{ .Date.Format "Jan 02, 2006" }}
                        {{ end }}
                    </span>
                    <span class="post-card-category">{{ index .Params.categories 0 }}</span>
                </div>
                <h2 class="post-card-title">{{ .Title }}</h2>
                <div class="post-card-excerpt">{{ .Summary | plainify | truncate 150 }}</div>
            </div>
        </a>
        {{ end }}
    </div>
</div>

<script>
    const filterButtons = document.querySelectorAll('.filter-btn');
    const postCards = document.querySelectorAll('.post-card');

    filterButtons.forEach(button => {
        button.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');

            filterButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');

            postCards.forEach(card => {
                const category = card.getAttribute('data-category');
                if (filter === 'all' || category === filter) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    });
</script>

{{ partial "ga4-events.html" . }}
{{ end }}
